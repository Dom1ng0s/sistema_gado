<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Ficha do Animal</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

    {% if animal %}
        <h1>Ficha T√©cnica: Brinco {{ animal[1] }}</h1>

        <div class="dashboard" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
            
            <div class="kpi-box" style="background-color: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0 0 10px 0; font-size: 16px; color: #1565c0;">Peso Atual</h3>
                <strong style="font-size: 24px;">{{ indicadores.peso_atual }} kg</strong>
            </div>

            <div class="kpi-box" style="background-color: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0 0 10px 0; font-size: 16px; color: #6a1b9a;">GMD (M√©dia)</h3>
                <strong style="font-size: 24px; color: #4a148c;">{{ indicadores.gmd }}</strong>
                <br><small style="font-size: 11px;">kg/dia em {{ indicadores.dias }} dias</small>
            </div>

            <div class="kpi-box" style="background-color: #e8f5e9; padding: 15px; border-radius: 8px; text-align: center;">
                <h3 style="margin: 0 0 10px 0; font-size: 16px; color: #2e7d32;">Ganho Total</h3>
                {% if indicadores.ganho_total >= 0 %}
                    <strong style="font-size: 24px; color: green;">+{{ indicadores.ganho_total }} kg</strong>
                {% else %}
                    <strong style="font-size: 24px; color: red;">{{ indicadores.ganho_total }} kg</strong>
                {% endif %}
            </div>

            <div class="kpi-box" style="background-color: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;"> 
                <h3 style="margin: 0 0 10px 0; font-size: 16px; color: #ef6c00;">Custo Total</h3>
                <strong style="font-size: 24px; color: #e65100;">R$ {{ indicadores.custo_total }}</strong>
            </div>
        </div>

        <div class="card">
            <h3>Dados Fixos</h3>
            <p><strong>Sexo:</strong> {{ animal[2] }}</p>
            <p><strong>Data de Compra/Nascimento:</strong> {{ animal[3] }}</p>
            <p><strong>Pre√ßo de Compra:</strong> R$ {{ animal[4] }}</p>
        </div>

        <hr>

        <hr>

        <h2>Evolu√ß√£o de Peso</h2>
        <a href="/pesar/{{ animal[0] }}" class="btn btn-peso">+ Nova Pesagem</a>
        
        <table>
            <thead>
                <tr>
                    <th>Data da Pesagem</th>
                    <th>Peso (kg)</th>
                    <th>A√ß√µes</th> </tr>
            </thead>
            <tbody>
                {% for pesagem in historico_peso %}
                <tr>
                    <td>{{ pesagem[2] }}</td>
                    
                    <td>{{ pesagem[3] }} kg</td>
                    
                    <td>
                        <a href="/excluir_pesagem/{{ pesagem[0] }}" 
                           style="color: red; text-decoration: none; font-weight: bold;"
                           onclick="return confirm('Tem certeza que deseja apagar este registro?');">
                           [X] Excluir
                        </a>
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="3">Nenhuma pesagem registrada.</td></tr>
                {% endfor %}
            </tbody>
        </table>

        <br><hr>

        <h2>Hist√≥rico Sanit√°rio (Vacinas/Rem√©dios)</h2>
        <a href="/medicar/{{ animal[0] }}" class="btn btn-med">+ Adicionar Vacina/Rem√©dio</a>

        <table>
            <thead>
                <tr>
                    <th>Data</th>
                    <th>Medicamento</th>
                    <th>Custo</th>
                    <th>Obs</th>
                </tr>
            </thead>
            <tbody>
                {% for med in historico_med %}
                <tr>
                    <td>{{ med[2] }}</td> <td>{{ med[3] }}</td> <td>R$ {{ med[4] }}</td> <td>{{ med[5] }}</td> </tr>
                {% else %}
                <tr><td colspan="4">Nenhuma medica√ß√£o registrada.</td></tr>
                {% endfor %}
            </tbody>
        </table>

    {% else %}
        <h1>Erro: Animal n√£o encontrado.</h1>
    {% endif %}

    <br>
    <div style="margin: 20px 0;">
            {% if not animal[6] %}
                <a href="/vender/{{ animal[0] }}" style="background-color: #d32f2f; color: white; padding: 10px 20px; text-decoration: none; font-weight: bold; border-radius: 5px;">
                    üí≤ Registrar Venda (Baixa)
                </a>
            {% else %}
                <div style="background-color: #ffebee; color: #c62828; padding: 10px; border: 1px solid #ef9a9a; display: inline-block; border-radius: 5px;">
                    <strong>VENDIDO</strong> em {{ animal[5] }} por R$ {{ animal[6] }}
                </div>
            {% endif %}
        </div>
<br><br><br>
    
    <div style="border: 2px solid red; padding: 20px; border-radius: 8px; background-color: #ffe6e6;">
        <h3 style="color: red; margin-top: 0;">Zona de Perigo</h3>
        <p>A√ß√µes irrevers√≠veis. Ao excluir o animal, todo o hist√≥rico de peso e vacinas ser√° apagado.</p>
        
        <a href="/excluir_animal/{{ animal[0] }}" 
           style="background-color: red; color: white; padding: 10px 20px; text-decoration: none; font-weight: bold; border-radius: 5px;"
           onclick="return confirm('ATEN√á√ÉO: Tem a certeza absoluta? Esta a√ß√£o apagar√° o animal e TODO o seu hist√≥rico para sempre.');">
           üóëÔ∏è EXCLUIR ANIMAL PERMANENTEMENTE
        </a>
    </div>

    <br><br>
    <a href="/" class="btn btn-voltar">Voltar ao Rebanho</a>
</body>
</html>